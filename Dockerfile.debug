FROM golang:1.17-buster
ENV CGO_ENABLED 0

RUN apt-get update && apt-get install -y --no-install-recommends inotify-tools psmisc
RUN go get github.com/go-delve/delve/cmd/dlv

COPY debug-entrypoint.sh /entrypoint.sh

VOLUME /dockerdev

WORKDIR /dockerdev

ENV DELVE_PORT 40000
ENV SERVICE_NAME service

EXPOSE 8000 $DELVE_PORT

ENTRYPOINT ["/entrypoint.sh"]